# OTA 全链路系统｜总蓝图与模块文档索引说明

> 文档定位：**系统级总索引 + 决策背景说明 + 待定事项清单**
> 目标读者：产品负责人 / 技术负责人 / 新加入的核心成员
> 使用方式：**先读本文件 → 再按模块进入对应 MD**

---

## 1. 产品与业务背景说明（Why we build this）

### 1.1 公司与业务形态

* 公司类型：OTA 线上旅行套餐售卖旅行社
* 核心售卖方式：

  * 以“套餐/产品”为单位
  * 通过多平台、多渠道售卖
  * 订单主要来源于外部渠道（抖音/美团/私域等）
  * 当前阶段以**人工运营、人工录单、人工核销**为主

### 1.2 当前痛点（系统建设动因）

在现有业务规模下，已出现以下问题：

1. **资源不可复用**

   * 同一景区/酒店被多次重复创建
   * 后续产品、价格、库存无法统一维护

2. **产品定义混乱**

   * 套餐靠人为记忆
   * 无法判断“是不是同一个产品”

3. **价格与成本不可追溯**

   * 调价直接覆盖
   * 无法回溯历史利润

4. **库存与核销口径不统一**

   * 超卖风险
   * 核销率统计不可信

5. **经营数据不可解释**

   * 数字对不上
   * 无法 drill-down 到订单

---

## 2. 系统总体设计思想（How we design）

### 2.1 总体原则

1. **订单是事实层**：所有经营指标以订单为准
2. **历史不可破坏**：价格、产品、库存、订单都必须可追溯
3. **人工优先、系统兜底**：不强行自动化，但严防事故
4. **结构先于灵活**：宁可约束清晰，也不无限扩展

### 2.2 全链路逻辑主线（从供给到经营）

```
供应商 → 资源 → 产品 → 商品(SKU) → 定价 → 库存 → 订单 → 核销 → 报表
```

这是所有模块设计的**唯一主线**，任何功能不得绕过该链路。

---

## 3. 文档结构与模块索引（How to read docs）

### 3.1 总蓝图文档

* 《OTA 全链路垂直数据库 · 总蓝图设计文档》

  * 描述整体架构
  * 定义模块边界
  * 不展开实现细节

> 本文档是“地图”，不是“施工图”。

---

### 3.2 模块级开发文档索引（施工图）

| 模块编号 | 模块名称          | 核心职责          |
| ---- | ------------- | ------------- |
| M1   | 供应商管理模块       | 供应商主数据 + 成本来源 |
| M2   | 资源库（POI & 资源） | 可复用资源底座       |
| M3   | 产品管理（资源组合）    | 套餐定义与唯一性      |
| M4   | 商品（SKU）与渠道    | 售卖形态与渠道差异     |
| M5   | 定价模块          | 售价/成本/价格历史    |
| M6   | 库存模块          | 是否可卖的最后闸门     |
| M7   | 订单 / 核销 / 退款  | 销售事实层         |
| M8   | 审批与审计         | 系统安全与追责       |
| M9   | 报表与经营看板       | 经营数据输出层       |

> 阅读顺序必须按 M2 → M1 → M3 → M4 → M5 → M6 → M7 → M8 → M9。

---

## 4. 模块依赖关系说明（Dependency Map）

* M2（资源）是**最底层**，无前置依赖
* M1（供应商）依赖 M2
* M3（产品）依赖 M2 + M1
* M4（SKU）依赖 M3
* M5（定价）依赖 M4
* M6（库存）依赖 M4 + M5
* M7（订单）依赖 M4 + M5 + M6
* M8（审批）横向作用于 M1–M7
* M9（报表）依赖 M7（主）+ 其他模块（辅）

---

## 5. 本期明确“不做”的事项（Scope Control）

为保证一期可交付，以下内容**明确不在当前范围**：

* ❌ 自动对接供应商库存/价格接口
* ❌ 动态定价、智能定价
* ❌ 自动核销 / 码核销体系
* ❌ 复杂退款（部分退款、改期）
* ❌ 数据仓库 / BI 系统
* ❌ 多币种结算
* ❌ 财务结算/对账/付款系统

这些内容在各模块中均已**预留扩展点，但不实现**。

---

## 6. 已知待定 / 需要后续决策的事项（Open Questions）

### 6.1 业务策略相关

1. 是否区分 GMV 与 实收金额
2. 是否需要区分“渠道补贴/平台抽佣”
3. 是否允许超卖（当前设计：**明确不允许**）

### 6.2 产品与销售策略

4. 是否支持多 SKU 订单（当前：不支持）
5. 是否支持可选资源 / 加购项
6. 是否需要渠道专属 SKU 模式

### 6.3 运营与流程

7. 审批人规则（按角色 / 按人 / 按金额）
8. 缺库存预警阈值的配置策略
9. 报表刷新频率（日更 / 实时）

### 6.4 技术实现层

10. 是否使用物化视图 / 聚合表
11. 订单表是否按月分区
12. 审计日志保存周期

> 以上问题均已在文档中留出**结构性空间**，不影响当前版本开发。

---

## 7. 本文档在整个体系中的角色

* 是**新成员的入门文档**
* 是**产品/技术对齐的共识文档**
* 是**未来扩展讨论的锚点文档**

> 任何新增需求，必须先回答：
> **“它落在哪个模块？是否破坏主链路？”**

---

## 8. 总结一句话

> 本系统不是为了“看起来高级”，而是为了：
> **在人工运营为主的现实条件下，把数据结构、经营事实和历史责任牢牢锁住。**

> 当系统能说清楚“卖了什么、赚没赚钱、为什么”，它就是一个合格的 OTA 内部系统。
