# -
数据库项目
0. 项目边界与目标（决定文档结构与取舍）

这次要交付的“产品”是什么形态：仅数据库 + 管理后台？还是要包含 API（对接小程序/APP/渠道）？

本期（MVP）必须上线的范围是哪些模块？（供应商/资源/产品/商品/渠道/定价/库存/订单/结算/内容营销…）

你们希望数据库主要解决什么痛点（Top 3）：

多渠道上架混乱？

定价体系不统一？

库存难同步？

结算对账困难？

商品与资源/产品映射关系不清？

预计数据量级：供应商数、资源数、产品数、商品数、日订单量、峰值 QPS（大概范围即可）。

上线节奏：是否需要分阶段（1期/2期/3期）？每期大概 2–4 周还是更长？

1. 核心名词与对象定义（避免“产品/商品/资源”混用）

你们内部对以下名词的定义是什么（请用一句话说明 + 举例）：

供应商（旅行社/地接/景区/酒店？）

资源（POI/门票/房型/线路中的某段服务？）

产品（可售卖的“套餐/线路/自由行组合”？）

商品（上架到渠道的 SKU？还是产品的销售载体？）

渠道（抖音/小红书/微信小程序/美团/携程？）

“商品信息 N:N 商品信息（图上）”这条 N:N 对应你们业务含义是什么？举例说明一个典型场景。

你们是否存在 一份产品在不同渠道以不同商品形态售卖（名称/图文/价格/库存/佣金不同）？

产品是否有多级结构：SPU/SKU？（如：线路 SPU，出发日期+成人人数+酒店等级 = SKU）

2. 资源库与 POI（图上“资源信息库”）

你们的“资源库”现在来源是什么：

手工录入

供应商提供

第三方（高德/百度/携程/美团/自建 POI）

POI/资源需要存哪些字段是“必需”的？（如：名称、地址、经纬度、城市、开放时间、联系方式、图片、标签…）

资源的类型有哪些：景点/酒店/餐厅/交通/导游/活动/签证…？需要支持扩展类型吗？

同一 POI 是否会被多个供应商复用？（例如同一个景区，不同旅行社都能卖）

资源是否需要“资质/证照/合同/附件”的管理？

3. 供应商管理（图上“财务信息、结算价格、比价、库存（更新难）”）

供应商分层/角色：旅行社、地接社、景区直采、票务代理、酒店供应商…？

供应商结算方式有哪些：预付/后付/月结/周结/按单结？是否有账期（T+N）？

供应商价格：你们需要管理哪些价格维度：

底价/结算价

建议零售价

同业价

阶梯价（人数/日期/淡旺季）

是否需要“供应商比价/备选供应商”能力（同一资源/产品，多供应商供给）？

供应商库存来源：

你们自己扣减

供应商接口同步

人工导入（Excel）

混合

供应商库存粒度是什么：按日期、按场次、按房量、按名额、按票种？

4. 产品管理（“资源组合成产品”，“常规品/组合品”）

产品类型有哪些：

跟团游

自由行

门票/一日游

酒店套餐

交通票

本地玩乐

“资源组合成产品”组合规则：

必选资源 + 可选资源？

套餐内包含次数/天数？

是否支持加购（增值项）？

产品是否需要“行程（D1/D2）”结构？（跟团/自由行经常需要）

产品的有效期/售卖期/出行期怎么定义？是否支持“提前N天可订/不可退改规则”？

是否需要“成团规则”（最少成团人数、截止时间）？

是否有 “预估利润/浮动比例/基础价格” 的计算模型？你希望系统自动算哪些指标？

5. 商品与渠道（“平台渠道-销售运营”）

渠道清单：目前确定要接入哪些？（微信小程序/抖音/小红书/美团/携程/飞猪…）

每个渠道对“商品”的要求是否不同：

类目/属性

图文结构

价格展示方式

库存接口

一个商品在渠道上是否需要单独的：标题、卖点、图集、详情、上下架状态、标签、推荐位？

渠道是否存在：达人分销/团长/直播间专属价/券？（这会强烈影响定价与结算模型）

渠道订单回流方式：API/导单/人工？是否需要实时？

6. 定价体系（图上“销售价格管理：基础价格、浮动比例、预估利润”）

你们希望定价是“自上而下”还是“自下而上”：

自下而上：供应商结算价 → 加价规则 → 渠道售价

自上而下：渠道目标售价 → 反推可接受结算价/毛利

价格规则需要支持哪些维度：渠道、日期、人数、节假日、城市、房型/票种、会员等级、券、活动价？

是否需要“价格审批流”（运营提价/降价，负责人审核）？

价格生效冲突如何处理：多个规则同时命中时优先级是什么？

需要留存价格历史吗？（通常必须，用于对账与售后）

7. 库存体系（图上提到“更新难”）

库存最终以谁为准：你们库存中心还是供应商？

库存扣减时机：下单即扣？支付成功扣？核销扣？

是否存在超卖容忍（可超卖 N 单）？

库存单位：名额、房晚、张票、车位…是否多单位共存？

是否需要“库存冻结”（例如支付中冻结、售后冻结）？

8. 订单、核销、售后、结算对账（是否纳入本次）

这次文档是否要覆盖订单域？（下单/支付/退款/改期/核销/出行确认）

核销方式：二维码/验证码/名单/人工确认？核销方是谁（供应商/自营导游/平台）？

退款/改期规则来源：产品规则？渠道规则？供应商规则？冲突如何裁决？

对账：需要生成哪些报表/单据：供应商对账单、渠道结算单、毛利报表？

发票/税务信息是否要管理？

9. 权限、组织与工作流

使用角色有哪些：运营、采购/供应链、财务、客服、内容编辑、渠道BD、管理员？

是否需要多组织/多店铺/多事业部（数据隔离）？

关键流程是否需要审批：上架、调价、签约、结算、退款？

10. 数据模型偏好（你希望我怎么落库）

你希望采用更“领域化拆表”（可扩展、复杂）还是更“扁平化易用”（开发快）？

是否需要多语言/多币种（未来出境游）？

对“变更追踪/审计字段”要求：谁在什么时候改了什么，是否必须？

需要软删除（deleted_at）还是硬删除？

是否需要全文检索（商品/资源搜索）？PGSQL 可用 tsvector。

11. 系统集成与现状迁移

现在是否已经有旧系统/表？如果有：

主要有哪些表/字段

数据质量如何

是否要迁移历史订单/历史价格

你们有没有现成的统一 ID 体系：supplier_id / resource_id / product_id / sku_id / channel_id？

需要对接哪些外部系统：支付、短信、ERP、财务、BI、CRM、IM客服？

12. 非功能要求（稳定性、安全、性能）

对可用性要求：是否需要高可用/主从/读写分离？

备份与恢复要求：每天备份？保留多久？

对隐私与安全：供应商合同/证照是否需要加密存储？是否有脱敏需求？

是否要求“所有关键操作可追溯日志”？

13. 交付物格式（我最终输出的 md 文档会包含什么）

你希望最终文档包含：

业务流程图（文字版）

ER 关系说明（表结构字段级）

状态机（上架/库存/订单）

API 草案（REST/GraphQL）

事件/消息（如库存变更事件）

权限矩阵

数据字典
哪些是必须？哪些可选？

你们技术栈偏好：是否已有后端语言/框架（Java/Spring、Go、Node、Python）？还是只要数据库设计为主？

命名风格偏好：表名 snake_case？字段英文还是中英混合？



回答: 
1.	是的，暂时不需要对接任何api，我们只需要后端数据库+前端数据录入/管理/查看
2.	第一期必须上线的包括资源库，供应商库，产品库，商品库和渠道库
3.	主要解决的是公司内部对于这些敏感信息，因为它的复杂性，时间敏感性，导致信息互通成本高，或者是导致误差，不一致，滞后。也解决了产品经理维护产品信息的复杂度，以及总经理对于整个公司的产品的情况的评估复杂度。
4.	预估数量级我暂时不清楚，但是我们只是运营云南省内的产品
5.	需要分阶段，第一阶段需要两周内完成
6.	供应商是指景区/酒店/餐厅/交通等提供直接服务的。资源是指这些供应商能给我们提供的东西。比如某家酒店能提供不同的房间，每一种房型是一个资源；某个景区能提供不同的票种（成人票，儿童票），每一种都是一个资源。要注意的是，同一种资源可以有多个供应商。产品是指一种或多种资源组合而成的套餐，不管是套餐还是线路（单独的资源本身也可以成为产品，并不一定需要组合）。要注意的是产品的唯一id是资源组合，例如a+b是一种产品，a+b+c是另一种产品，他们没有任何子关系。商品就是指上架到不同渠道的sku。要注意的是一个产品可以衍生出多个商品，例如有一个产品A，那么美团-A和抖音-A是两个商品，同时正常A和节假日A（价格不一样）是两个商品。渠道顾名思义就是我们上架商品的地方，包括了抖音，美团，小红书，携程，飞猪，去哪儿，微信小程序等等，每个渠道下面可能还有子渠道（不同门店）。
7.	这里的N:N单纯是指一个商品可以上架多个渠道，多个商品也可以只上架一个渠道（没有限制）
8.	一份产品在不同渠道肯定会以不一样的商品形态出售，包括价格，图片等等（因为平台的规则不一样）
9.	不用搞那么复杂，前期暂时不要搞这个分类。
10.	资源库现在的方式是供应商加产品经理手动整理成电子表格，因此没有直连的可能性，所有非计算类信息都需要做GUI界面让产品经理进行手动录入（或者按格式进行cvs导入）
11.	字段待定，这个东西非常重要，所以需要细致讨论，但是这个不影响框架搭建。
12.	资源类型之前已经说了，肯定需要支持扩展的，字段理论上也需要支持扩展的（只是表与表之间的关系得处理好，避免扩展后报错）
13.	这个暂时不用管，不做限制就行了
14.	不需要
15.	做一个字段分类就行，不需要硬性分类
16.	待定
17.	待定
18.	需要
19.	我们自己扣减（手动点击按钮和excel导入）
20.	按不同资源种类每天的库存计算
21.	你说的这些都有，但是不用硬性卡死，把它做成一个字段便于分类和查找就行
22.	暂时不用管这个
23.	不需要
24-25. 这些单独用字段“产品详情”写就行了，不需要硬性规定
26. 肯定要根据销售库导入的数据自动计算一些销售报告，包括利润，销售额，核销率等等
27.  上面已经说了，要包括抖音，美团，小红书，携程，飞猪，去哪儿，微信小程序，且要支持扩展
28-30. 每个渠道都有独特的这些特征和不同，无法详细根据这些不同去进行编码和设计（因为太庞杂），最好就是用字段概括一些重要的内容，方便分类和筛查
31. 人工（手动输入/excel导入），不需要实时，定期就行（理想情况每天）
32. 自下而上：供应商结算价 → 加价规则 → 渠道售价 （但是最终定价权是产品经理手中，不需要写脚本自动计算）
33. 价格通常受日期，节假日，渠道（平台费不一样），直播与否，有无活动，是否有优惠卷影响
34. 是需要的，不仅价格，任何产品信息的改动都需要产品经理进行审批
35. 通常不会有这个冲突，不用考虑这个，如之前所说，不同平台，不同日期节假日同一产品都会是不同的商品。美团-A-工作日，抖音-A-工作日，抖音-A-节假日是三个不同的商品
36. 必须要留存
37. 库存中心。由供应商发送给我们我们手动录入和维护（无法直连供应商系统）
38. 支付成功扣，但是still，无法直连渠道，所以扣除库存由运营手动在我们前端进行扣除
39. 不允许
40. 库存单位可以根据不同资源单独做一个子表列出来，但是对整体框架和结构影响不大，作为一个支撑作用
41. 需要的，支付后，运营冻结库存，若成功核销，则扣除库存，若退款则解冻库存。 （前端的交互要做明确）
42. 要覆盖的
43. 具体的核销方式和核销方不用管，因为最后都是运营来这个系统进行核销和数据录入
44. 这个和这个系统关系不大，不需要管这个
45.  主要的表之前已经说过了，主要是渠道销售端的销售表，后端的供应链报表暂时不需要
46. 不用
47-49. 运营，客服，产品，主管（最高权限）。运营和客服共同负责录入和处理销售订单信息（主要是客服，因为他们处理每一单）。运营还要负责每个平台的商品录入和维护。产品要负责组合并录入产品信息，录入资源和供应商信息。每个角色的操作界面和信息都应该独立开（除非主管手动调整权限）。但是渠道与渠道之间不需要根据权限独立（但是肯定是要用不同的表）。和之前说的一样，只有商品的价格等敏感信息修改和上新需要产品经理进行审批，其他的操作都不需要审批，避免效率低下。
50. 领域化拆表
51. 不需要
52. 需要设计一个日志功能记录这个
53. 任何前端数据修改都需要直接反馈到数据库，确保数据直接性（需要审批的操作需要审批通过才能操作）
54. 需要全文搜索，字段搜索，表搜索（关键词搜索，实时显示（不需要点回车）），还需要字段分类，需要表分类（类似文件夹结构，按每个库分表，能够直观点进去观看）。需要字段筛选（从小到大，从大到小，选框勾选）。
55. 没有
56. 也没有，但是不同库，不同表内的字段后续会由产品经理详细写出来并赋予他们的数据格式和含义。我知道这个非常关键，但是目前来说先考虑把大的框架和其他内容做出来，后续进行补充。
57. 不对接任何外部系统
58. 是的，读写分离非常重要（主要是UX/UI交互的设计，避免误操作）
59. 要备份的，每天备份一次，最多存储3天
60. 不需要
61. 之前说过的，所有后端数据改动都要留存日志，日志存储30天的，以json格式存储，支持下载。
62. 最终文档我不仅需要你说的包括的所有东西，还要包括全部细节的技术栈，包括模块功能详解，包括前端视觉表现，包括系统的全套垂直底层逻辑。这个文档我需要越详细越好，包括了例子，不要省略我们讨论的任何细节。（因为我要用这个文档进行vide coding）
63. 后端用python和pgsql，前端用什么你自己考虑，但是要确保ui/ux流畅，美观，现代化，不会因为数据量太大导致前端崩溃。
64. 后端命名风格最好以中英混合，前端用全中文。
